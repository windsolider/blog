---
title: http
date: 2017-12-28 10:44:24
tags:
---
## http报文
---------------
用于http协议交互的信息被称为http报文。客户端的http报文叫做请求报文，服务器端的叫做响应报文。

### 请求报文
请求报文的组成：报文首部 + 空行 + 报文主体
报文首部的组成：请求行 + 请求首部字段 + 通用首部字段 + 实体首部字段 + 其他
### 响应报文
响应报文的组成：报文首部 + 空行 + 报文主体
报文首部的组成：状态行 + 响应首部字段 + 通用首部字段 + 实体首部字段 + 其他
## http缓存
---------------
缓存是指代理服务器或者客户端保存的资源副本
当浏览器第一次对于服务器上的资源请求时候，http请求的响应头中可以通过设置cache-control(1.1)或者Expires(1.0)字段强制要求浏览器对资源进行缓存。假定在首次获取资源120秒后，浏览器又对该资源发起请求。首先，浏览器会检查本地缓存并找到之前的响应，通过date字段与cache-control字段的时间进行比对，（date字段表示当前http报文生成日期），判断该缓存是否过期。如果未过期，则继续使用本地缓存内容。如果过期，浏览器直接发起新的请求并获取完新的完整响应。浏览器的请求头中将之前第一次接收到的etag内容通过if-none-match发送给服务器，如果服务器上的etag内容与客户端发送过来的if-none-match内容一致，则表示资源未发生变化，浏览器可以继续使用本地缓存。如果不一致，则服务器返回最新的资源给浏览器。

ps: 如何查看chrome浏览器本地缓存
* 打开chrome浏览器
* 在chrome浏览器地址栏中输入chrome://chrome-urls/,打开所有chrome-URL相关的列表页面
* 在列表中选择chrome://cache，打开缓存页面看到缓存的资源列表

浏览器发出的所有http请求会首先路由到浏览器缓存，以确认是否缓存了可用于满足请求的有效响应

1.DNS域名解析；
2.建立TCP连接；
3.发送HTTP请求；
4.服务器处理请求；
5.返回响应结果；
6.关闭TCP连接；
7.浏览器解析HTML；
8.浏览器布局渲染；

## reference
-------------------
* [从Chrome源码看DNS解析过程](https://mp.weixin.qq.com/s/K7rdF82yi-yGk5-aN9Se8A)
* [浏览器中输入url后发生了什么](https://www.jianshu.com/p/c1dfc6caa520)
* [在浏览器中输入URL并回车后都发生了什么](https://www.cnblogs.com/tisikcci/p/5866753.html)




